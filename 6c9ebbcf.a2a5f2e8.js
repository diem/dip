(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{175:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return b}));var a=n(1),i=n(9),r=(n(0),n(196)),l={lip:5,title:"Address formatting",authors:"Dmitry Pimenov (@dpim)",status:"draft",type:"informational",created:"07/08/2020"},s={id:"lip-5",title:"Address formatting",description:"# Summary",source:"@site/all-docs__GENERATED/lip-5.md",permalink:"/lip-5",editUrl:"https://github.com/libra/lip/edit/master/all-docs__GENERATED/lip-5.md"},c=[{value:"Account identifiers",id:"account-identifiers",children:[{value:"Desired attributes",id:"desired-attributes",children:[]},{value:"Constraints for subaddresses",id:"constraints-for-subaddresses",children:[]},{value:"Format",id:"format",children:[]},{value:"Example with explicit subaddress",id:"example-with-explicit-subaddress",children:[]},{value:"Example without explicit subaddress (root account)",id:"example-without-explicit-subaddress-root-account",children:[]},{value:"Looking ahead",id:"looking-ahead",children:[]}]},{value:"Intent identifiers",id:"intent-identifiers",children:[{value:"Desired attributes",id:"desired-attributes-1",children:[]},{value:"Format",id:"format-1",children:[]},{value:"Example of request intent",id:"example-of-request-intent",children:[]},{value:"Example of request intent with currency specified",id:"example-of-request-intent-with-currency-specified",children:[]},{value:"Example of request intent with currency and amount specified",id:"example-of-request-intent-with-currency-and-amount-specified",children:[]},{value:"Looking ahead",id:"looking-ahead-1",children:[]}]}],o={rightToc:c};function b(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},o,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"summary"},"Summary"),Object(r.b)("p",null,"Libra wallets benefit from consistent standards for serializing addresses and transaction requests. Such standards will enable an evolving set of interoperable payments scenarios across digital wallet clients. This proposal outlines an initial set of address formats."),Object(r.b)("h1",{id:"terminology"},"Terminology"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"on-chain account address"),": Account addresses on the Libra blockchain are 16 bytes in length. The on-chain accounts corresponding to these blockchain addresses are containers that can hold Move resources including coin balances. We expect that many custodial wallets will choose to use a single or small set of on-chain accounts to act as an omnibus for their users. An example of an on-chain account address is ",Object(r.b)("inlineCode",{parentName:"p"},"0xf72589b71ff4f8d139674a3f7369c69b"),".")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"subaddress"),": Accounts on-chain are represented by an address.  To allow multiplexing of a single address into multiple wallets, custodial wallets may use \u201csubaddresses\u201d under the on-chain address for each underlying user.  While custodians can keep an internal ledger for mapping subaddresses, these virtual identifiers are not stored as resources on the Libra blockchain. A best practice is to use subaddresses as a single-use address to remove linkability.  In this way, subaddresses serve as a many-to-one mapping between subaddresses and a user - where ideally subaddresses are not re-used for more than one payment.")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"account identifier"),":  An account identifier is a base-32 encoded string that captures 1) the network version the address is intended for, 2) the address type (with or without subaddress) and 3) the underlying address components. This identifier uses the bech32 encoding which consists of a human readable prefix, delimiter, serialized payload (account address, subaddress) and checksum. An example of an account identifier is ",Object(r.b)("inlineCode",{parentName:"p"},"lbr1p7ujcndcl7nudzwt8fglhx6wxn08kgs5tm6mz4usw5p72t"),".")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},"intent identifier"),": An intent identifier is a URI-serialized string that couples an ",Object(r.b)("em",{parentName:"p"},"account identifier")," with optional query parameters that specify preferences for an on-chain action. Initially, intent identifiers will be used for specifying transaction requests. In the fullness of time, we can expect using intent identifiers for sharing richer transaction metadata or identity information. an example of an intent identifier is ",Object(r.b)("inlineCode",{parentName:"p"},"libra://lbr11q8mjtzdhrl6035feva9r7umfc6du7ezz300tv2hj7v5pyg?am=1000000&c=LBR")))),Object(r.b)("h1",{id:"abstract--motivation"},"Abstract / Motivation"),Object(r.b)("p",null,"For a range of peer-to-peer and peer-to-merchant use cases, merchants and wallets will need to coordinate an information exchange about the intended recipient and transaction payload. Standardizing the format of this payment envelope promotes interoperability across the client ecosystem. This proposal covers standards for several related identifiers."),Object(r.b)("p",null,"A common pattern to a cross-wallet transaction would be:"),Object(r.b)("p",null,"1) The recipient generates a ",Object(r.b)("em",{parentName:"p"},"intent identifier")," consisting of their account identifier, and payment metadata\n2) The recipient shares this information with a would-be sender over some communication channel (eg. SMS, Email, QR code)\n3) The sender's wallet deserializes this information and populates a transaction for the sending user to authorize\n4) The sending user authorizes the request and their wallet submits the transaction to the Libra blockchain\n5) The recipient wallet monitors on-chain events for its accounts and identifies a specific transaction by the unique subaddress passed in the transaction's metadata fields. Upon observing such a transaction, they can confirm funds have been received."),Object(r.b)("p",null,"Examples of cross-wallet payment scenarios include:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"A user may want to share a compact identifier over traditional communication channels (eg. SMS) and receive a payment from a user of a different wallet",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"The recipient user may want to specify a currency preference"),Object(r.b)("li",{parentName:"ul"},"The recipient user may want to specify a concrete amount they'd like to receive"))),Object(r.b)("li",{parentName:"ul"},"A merchant may want to present a predefined payment request via QR code so that a customer would only need to authorize the funds")),Object(r.b)("h1",{id:"specification"},"Specification"),Object(r.b)("h2",{id:"account-identifiers"},"Account identifiers"),Object(r.b)("p",null,"For communicating account identity, we propose using a compact, versioned and case-insensitive identifier. To meet this criteria, we selected the Bech32 encoding implementation used in Bitcoin Segwit (",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki"}),"BIP 0173"),") excluding the Segwit byte known-length restrictions."),Object(r.b)("h3",{id:"desired-attributes"},"Desired attributes"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Consistent - Users can build a muscle memory for identifying and using these account addresses"),Object(r.b)("li",{parentName:"ul"},"Atomic - The string identifier feels like a single unit. Users shouldn\u2019t try to separate or truncate the string"),Object(r.b)("li",{parentName:"ul"},"Versioned - The format contains human readable information about how to interpret the payload, preventing subtle errors and reducing risk of linkability for human readable addresses"),Object(r.b)("li",{parentName:"ul"},"Error detecting - Bech32 checksums help clients validate input and reduce risk of bad transactions due to mistypings and truncations")),Object(r.b)("h3",{id:"constraints-for-subaddresses"},"Constraints for subaddresses"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Fixed length at 8 bytes (we don\u2019t accept other sizes, strictly 8 bytes)."),Object(r.b)("li",{parentName:"ul"},"Unique to their custodian/on-chain account: subaddresses must be non-ambiguous (ie. Recipient VASPs should not issue the same subaddress to multiple users)."),Object(r.b)("li",{parentName:"ul"},"By convention, 8 zero bytes (",Object(r.b)("inlineCode",{parentName:"li"},"0x0000000000000000"),") is reserved to denote the root (VASP owned) account.")),Object(r.b)("h3",{id:"format"},"Format"),Object(r.b)("p",null,"The Libra Account Identifier consists of"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"A prefix (also known as hrp (human readable part) which identifies the network version this address is intended for",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"\u201clbr\u201d for Mainnet addresses"),Object(r.b)("li",{parentName:"ul"},"\u201ctlb\u201d for Testnet addresses"))),Object(r.b)("li",{parentName:"ul"},"A Bech32 delimiter",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"The character \u201c1\u201d (one)"))),Object(r.b)("li",{parentName:"ul"},"A Bech32 version identifier",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"The character \u201cp\u201d (version = 1) for on-chain with subaddress"))),Object(r.b)("li",{parentName:"ul"},"A Bech32 encoded payload",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"For version 1, is Libra account address + subaddress (16 + 8 bytes)"))),Object(r.b)("li",{parentName:"ul"},"The last 6 characters correspond to the Bech32 checksum")),Object(r.b)("p",null,"Overall address format: ",Object(r.b)("em",{parentName:"p"},"prefix")," | ",Object(r.b)("em",{parentName:"p"},"delimiter")," | ",Object(r.b)("em",{parentName:"p"},"version")," | ",Object(r.b)("em",{parentName:"p"},"encoded payload")," | ",Object(r.b)("em",{parentName:"p"},"checksum")),Object(r.b)("h3",{id:"example-with-explicit-subaddress"},"Example with explicit subaddress"),Object(r.b)("p",null,"Identifier information"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Prefix (string)",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Network: ",Object(r.b)("inlineCode",{parentName:"li"},"lbr")))),Object(r.b)("li",{parentName:"ul"},"Address type (version prefix): ",Object(r.b)("inlineCode",{parentName:"li"},"01")," (letter p in Bech32 alphabet)"),Object(r.b)("li",{parentName:"ul"},"Address payload (in hex)",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Address: ",Object(r.b)("inlineCode",{parentName:"li"},"0xf72589b71ff4f8d139674a3f7369c69b")),Object(r.b)("li",{parentName:"ul"},"Subaddress: ",Object(r.b)("inlineCode",{parentName:"li"},"0xcf64428bdeb62af2")))),Object(r.b)("li",{parentName:"ul"},"Checksum: ",Object(r.b)("inlineCode",{parentName:"li"},"w5p72t"))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Result"),": ",Object(r.b)("inlineCode",{parentName:"p"},"lbr1p7ujcndcl7nudzwt8fglhx6wxn08kgs5tm6mz4usw5p72t")),Object(r.b)("h3",{id:"example-without-explicit-subaddress-root-account"},"Example without explicit subaddress (root account)"),Object(r.b)("p",null,"Identifier information"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Prefix (string)",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Network: ",Object(r.b)("inlineCode",{parentName:"li"},"lbr")))),Object(r.b)("li",{parentName:"ul"},"Address type (version prefix): ",Object(r.b)("inlineCode",{parentName:"li"},"01")," (letter p in Bech32 alphabet)"),Object(r.b)("li",{parentName:"ul"},"Address payload (in hex)",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Address: ",Object(r.b)("inlineCode",{parentName:"li"},"0xf72589b71ff4f8d139674a3f7369c69b")),Object(r.b)("li",{parentName:"ul"},"Subaddress: ",Object(r.b)("inlineCode",{parentName:"li"},"0x0000000000000000")))),Object(r.b)("li",{parentName:"ul"},"Checksum: ",Object(r.b)("inlineCode",{parentName:"li"},"flf8ma"))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Result"),": ",Object(r.b)("inlineCode",{parentName:"p"},"lbr1p7ujcndcl7nudzwt8fglhx6wxnvqqqqqqqqqqqqqflf8ma")),Object(r.b)("h3",{id:"looking-ahead"},"Looking ahead"),Object(r.b)("p",null,"In the future, we plan to define additional Account Identifier versions to support other forms of identity, such as a more human-readable subaddress format. These would leverage a similar overall structure but would have a different version identifier, preventing naming collisions."),Object(r.b)("h2",{id:"intent-identifiers"},"Intent identifiers"),Object(r.b)("p",null,"In addition to the Account Identifier standard, we propose a common serialization format for denoting specific actions involving an on-chain account. This format is intended to evolve and support a broad range of user-to-user and user-to-merchant scenarios."),Object(r.b)("h3",{id:"desired-attributes-1"},"Desired attributes"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Familiar - define standards that are easy to understand and implement (by merchant, exchange and wallet developers)"),Object(r.b)("li",{parentName:"ul"},"Interoperable - a single integration can support all wallets without vendor-specific setup"),Object(r.b)("li",{parentName:"ul"},"Extensible - a versioned protocol with room for supporting new capabilities")),Object(r.b)("h3",{id:"format-1"},"Format"),Object(r.b)("p",null,"The Intent Identifier consists of"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"A prefix",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"libra://")," to explicitly specify how the identifier should be interpreted"))),Object(r.b)("li",{parentName:"ul"},"A base URI",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Defines what resource the requested action is for"),Object(r.b)("li",{parentName:"ul"},"Initially, these will be account identifiers"))),Object(r.b)("li",{parentName:"ul"},"Query parameters",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Provides details for how the request should be fulfilled"),Object(r.b)("li",{parentName:"ul"},"Initially, currency code and amount to specify transaction request preferences",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"currency uses the 'c' key, with the value encoded as a 3-letter currency code (ex. LBR)"),Object(r.b)("li",{parentName:"ul"},"amount uses the 'am' key, with the value encoded in micro units (10e-6)")))))),Object(r.b)("h3",{id:"example-of-request-intent"},"Example of request intent"),Object(r.b)("p",null,"This intent represents a request to receive funds at a given address. Since neither the amount nor currency are prefilled, the sender will define these fields."),Object(r.b)("p",null,"Identifier information"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Prefix",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"libra://")))),Object(r.b)("li",{parentName:"ul"},"Base URI",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Account Identifier: ",Object(r.b)("inlineCode",{parentName:"li"},"lbr1p7ujcndcl7nudzwt8fglhx6wxn08kgs5tm6mz4usw5p72t")))),Object(r.b)("li",{parentName:"ul"},"Query parameters",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"none")))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Result"),": ",Object(r.b)("inlineCode",{parentName:"p"},"libra://lbr1p7ujcndcl7nudzwt8fglhx6wxn08kgs5tm6mz4usw5p72t")),Object(r.b)("h3",{id:"example-of-request-intent-with-currency-specified"},"Example of request intent with currency specified"),Object(r.b)("p",null,"This intent represents a request to receive funds in a specific currency at a given address. The amount is defined by the sender."),Object(r.b)("p",null,"Identifier information"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Prefix",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"libra://")))),Object(r.b)("li",{parentName:"ul"},"Base URI",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Account Identifier: ",Object(r.b)("inlineCode",{parentName:"li"},"lbr1p7ujcndcl7nudzwt8fglhx6wxn08kgs5tm6mz4usw5p72t")))),Object(r.b)("li",{parentName:"ul"},"Query parameters",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"c=LBR")," (currency preference is LBR composite token)")))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Result"),": ",Object(r.b)("inlineCode",{parentName:"p"},"libra://lbr1p7ujcndcl7nudzwt8fglhx6wxn08kgs5tm6mz4usw5p72t?c=LBR")),Object(r.b)("h3",{id:"example-of-request-intent-with-currency-and-amount-specified"},"Example of request intent with currency and amount specified"),Object(r.b)("p",null,"This intent represents a request to receive a specific amount in a specific currency for a given address."),Object(r.b)("p",null,"Identifier information"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Prefix",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"libra://")))),Object(r.b)("li",{parentName:"ul"},"Base URI",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Address: ",Object(r.b)("inlineCode",{parentName:"li"},"lbr1p7ujcndcl7nudzwt8fglhx6wxn08kgs5tm6mz4usw5p72t")))),Object(r.b)("li",{parentName:"ul"},"Query parameters",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"c=LBR&am=1000000")," (request for 1 LBR, currency preference is LBR composite token, amount is 1000000 \xb5-units)")))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Result"),": ",Object(r.b)("inlineCode",{parentName:"p"},"libra://lbr1p7ujcndcl7nudzwt8fglhx6wxn08kgs5tm6mz4usw5p72t?c=LBR&am=1000000")),Object(r.b)("h3",{id:"looking-ahead-1"},"Looking ahead"),Object(r.b)("p",null,"We expect to evolve the Intent Identifier to support a broader range of payment and identity scenarios. These may range from sharing stable identity information to supporting richer payment metadata."))}b.isMDXComponent=!0},196:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=i.a.createContext({}),b=function(e){var t=i.a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s({},t,{},e)),n},d=function(e){var t=b(e.components);return i.a.createElement(o.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},p=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,o=c(e,["components","mdxType","originalType","parentName"]),d=b(n),p=a,m=d["".concat(l,".").concat(p)]||d[p]||u[p]||r;return n?i.a.createElement(m,s({ref:t},o,{components:n})):i.a.createElement(m,s({ref:t},o))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var o=2;o<r;o++)l[o]=n[o];return i.a.createElement.apply(null,l)}return i.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"}}]);